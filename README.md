# SP-Methods-for-IMC
Code to reproduce results in upcoming IEEE TSP paper: Signal Processing Methods to Enhance the Energy Efficiency of In-Memory Computing Architectures

This repository is divided into three parts: **analysis**, **simulation**, and **dnn_snr**

## Analysis
The `analysis` folder contains code associated with the optimal clipping criterion and its various theoretical results. The file `analysis/NR_search.py` can be used to fine the various optimal clipping levels for a given number of bits. These are listed in *Table II* in our paper. The file `analysis/mse_vs_zeta.py` can be used to study the impact of number of bits on the value of optimal clipping levels and the resulting MSE. This file can be used to reproduce *Figure 3* in our paper. The file `analysis/distributions_and_mses.py` can be used to visualize the impact of quantization strategy. The tools provided here can be used to reproduce *Figure 2* in our paper.

## Simulation
The `simulations` folder contains code associated with the varous simulations results we have presented in *Sections III & IV* of our paper. The file `digital_dp_sqnr.py` can be used to evaluate (by means of derived formula and via Monte Carlo simulations) the impact of output precision and quantization strategy for digital dot products. This file can be used to reproduce the results of *Figure 4(a)* in our paper. The file `imc_dp_sqnr.py` can be used to evaluate (by means of derived formula and via Monte Carlo simulations) the impact of ADC precision and quantization strategy for IMC dot products implemented using the ISWP architecture. This file can be used to reproduce the results of *Figure 4(b)* in our paper. Similarly, the file `imc_dp_snr.py` does the same but also include analog noise and hence studies the dot-product SNR. The corresponding result is included in *Figure 4(c)* in our paper. The file `bit_sliced_sqnr.py` studies the impact of the number of bits per slice in the SIWP architecture for a given ADC precision on the dot-product SQNR. The latter is computed via evluation of derived expressions as well as Monte Carlo simulations. The corresponding results are included in *Figrue 6(a)* of our paper. Similarly, the file  `bit_sliced_snr.py` studies the SNR under the same setup, but with analog noise included. The corresponding results are included in *Figrue 6(b)* of our paper.

## DNN SNR
The `dnn_snr` folder contains code associated with the various results of *Section V* in our paper. There are three folders, each corresponding to the three networks studied: `dnn_snr/vgg_cifar` corresponds to the results of our VGG network on CIFAR-10. `dnn_snr/resnet_cifar` corresponds to the results of our ResNet network on CIFAR-10. `dnn_snr/alexnet_imagenet` corresponds to the results of our VGG network on CIFAR-10. All three folders contain similar contents. The file `dnn_snr/network_dataset/extract_DPs.py` contains pytorch code to extract a random set of activations and weights used to construct the set of random dot-products used in *Section V* for SNR analyses using Monte Carlo simulations. The file `dnn_snr/network_dataset/quantized_inference.py` can be used to evaluate the accuracy of the FX implementation which is reported in *Table III* of our paper. The file `dnn_snr/network_dataset/snr.py` can be used to evaluate the SNR as a function of ADC precision and energy per operation for the extracted set of random dot-products. This is done by doing Mont Carlo simulations using an emulated ISWP architecture. The corresponding results are included in *Figures 7 & 8* in our paper.

## Questions, Comments, Feedback
Please contact Charbel Sakr at `csakr@nvidia.com`
